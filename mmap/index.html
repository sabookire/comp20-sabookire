<!DOCTYPE html>
<html>
<head>
	<title>Geolocation Map Example</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<script type="text/javascript" 
	src="http://maps.googleapis.com/maps/api/js?sensor=true&amp;libraries=places"></script>
	<link rel="stylesheet" href="style.css" />
	
	<script>
	// declare global variables
	var myLat = 0;
	var myLng = 0; 
	var map;
	var marker;
	var places;
	var me = new google.maps.LatLng(myLat, myLng);
	var infowindow = new google.maps.InfoWindow();
	var request = new XMLHttpRequest();
	var myOptions = {
		zoom: 13,
		center: me,
		mapTypeId: google.maps.MapTypeId.ROADMAP
       };
	
	//initialize map
	function init () {
		map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
		console.log("Call before getMyLocation()");
		getMyLocation();
		console.log("Call after getMyLocation()");
	}

	// get my location
	function getMyLocation () {
		console.log("In getMyLocation()");
			if (navigator.geolocation) { // the navigator.geolocation object is supported on your browser
				navigator.geolocation.getCurrentPosition(function(position) {
				myLat = position.coords.latitude;
				myLng = position.coords.longitude;
						loadMap();
					});
				}
			else {
				alert("Geolocation is not supported by your web browser.  What a shame!");
				}
				console.log("Leaving getMyLocation()");
	}

	function loadMap() {
		me = new google.maps.LatLng(myLat, myLng);
				
		// Update map and go there...
		map.panTo(me);
	
		// Create a marker
		marker = new google.maps.Marker({
		position: me,
		title: "Here I Am!"
		});
		marker.setMap(map);
					
		// Open info window on click of marker
		google.maps.event.addListener(marker, 'click', function() {
			infowindow.setContent(marker.title);
			infowindow.open(map, marker);
		});
				
	}

	//function parse() {
	//	request.open("GET", "data.json", true);
	//	request.
	//}
</script>
</head>
<body onload = "init()">
	<h1>The Real Marauder's Map</h1>
	<div id="map_canvas"></div>
</html>